{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Synthetic Data Engine \ud83d\udc8e","text":"<p>Documentation | Technical Paper | Free Cloud Service</p> <p>Create high-fidelity privacy-safe synthetic data:</p> <ol> <li>prepare, analyze, and encode original data</li> <li>train a generative model on the encoded data</li> <li>generate synthetic data samples to your needs:<ul> <li>up-sample / down-sample</li> <li>conditionally generate</li> <li>rebalance categories</li> <li>impute missings</li> <li>incorporate fairness</li> <li>adjust sampling temperature</li> </ul> </li> </ol> <p>...all within your safe compute environment, all with a few lines of Python code \ud83d\udca5.</p> <p>Note: This library is the underlying model engine of the Synthetic Data SDK. Please refer to the latter, for an easy-to-use, higher-level software toolkit.</p>"},{"location":"#installation","title":"Installation","text":"<p>The latest release of <code>mostlyai-engine</code> can be installed via pip:</p> <pre><code>pip install -U mostlyai-engine\n</code></pre> <p>or alternatively for a GPU setup (needed for LLM finetuning and inference): <pre><code>pip install -U 'mostlyai-engine[gpu]'\n</code></pre></p> <p>On Linux, one can explicitly install the CPU-only variant of torch together with <code>mostlyai-engine</code>:</p> <pre><code>pip install -U torch==2.8.0+cpu torchvision==0.23.0+cpu mostlyai-engine --extra-index-url https://download.pytorch.org/whl/cpu\n</code></pre>"},{"location":"#quick-start","title":"Quick start","text":""},{"location":"#tabular-model-flat-data-without-context","title":"Tabular Model: flat data, without context","text":"<pre><code>from pathlib import Path\nimport pandas as pd\nfrom mostlyai import engine\n\n# set up workspace and default logging\nws = Path(\"ws-tabular-flat\")\nengine.init_logging()\n\n# load original data\nurl = \"https://github.com/mostly-ai/public-demo-data/raw/refs/heads/dev/census\"\ntrn_df = pd.read_csv(f\"{url}/census.csv.gz\")\n\n# execute the engine steps\nengine.split(                         # split data as PQT files for `trn` + `val` to `{ws}/OriginalData/tgt-data`\n  workspace_dir=ws,\n  tgt_data=trn_df,\n  model_type=\"TABULAR\",\n)\nengine.analyze(workspace_dir=ws)      # generate column-level statistics to `{ws}/ModelData/tgt-stats/stats.json`\nengine.encode(workspace_dir=ws)       # encode training data to `{ws}/OriginalData/encoded-data`\nengine.train(                         # train model and store to `{ws}/ModelStore/model-data`\n    workspace_dir=ws,\n    max_training_time=1,              # limit TRAIN to 1 minute for demo purposes\n)\nengine.generate(workspace_dir=ws)     # use model to generate synthetic samples to `{ws}/SyntheticData`\npd.read_parquet(ws / \"SyntheticData\") # load synthetic data\n</code></pre>"},{"location":"#tabular-model-sequential-data-with-context","title":"Tabular Model: sequential data, with context","text":"<pre><code>from pathlib import Path\nimport pandas as pd\nfrom mostlyai import engine\n\nengine.init_logging()\n\n# set up workspace and default logging\nws = Path(\"ws-tabular-sequential\")\nengine.init_logging()\n\n# load original data\nurl = \"https://github.com/mostly-ai/public-demo-data/raw/refs/heads/dev/baseball\"\ntrn_ctx_df = pd.read_csv(f\"{url}/players.csv.gz\")  # context data\ntrn_tgt_df = pd.read_csv(f\"{url}/batting.csv.gz\")  # target data\n\n# execute the engine steps\nengine.split(                         # split data as PQT files for `trn` + `val` to `{ws}/OriginalData/(tgt|ctx)-data`\n  workspace_dir=ws,\n  tgt_data=trn_tgt_df,\n  ctx_data=trn_ctx_df,\n  tgt_context_key=\"players_id\",\n  ctx_primary_key=\"id\",\n  model_type=\"TABULAR\",\n)\nengine.analyze(workspace_dir=ws)      # generate column-level statistics to `{ws}/ModelStore/(tgt|ctx)-data/stats.json`\nengine.encode(workspace_dir=ws)       # encode training data to `{ws}/OriginalData/encoded-data`\nengine.train(                         # train model and store to `{ws}/ModelStore/model-data`\n    workspace_dir=ws,\n    max_training_time=1,              # limit TRAIN to 1 minute for demo purposes\n)\nengine.generate(workspace_dir=ws)     # use model to generate synthetic samples to `{ws}/SyntheticData`\npd.read_parquet(ws / \"SyntheticData\") # load synthetic data\n</code></pre>"},{"location":"#language-model-flat-data-without-context","title":"Language Model: flat data, without context","text":"<pre><code>from pathlib import Path\nimport pandas as pd\nfrom mostlyai import engine\n\n# init workspace and logging\nws = Path(\"ws-language-flat\")\nengine.init_logging()\n\n# load original data\ntrn_df = pd.read_parquet(\"https://github.com/mostly-ai/public-demo-data/raw/refs/heads/dev/headlines/headlines.parquet\")\ntrn_df = trn_df.sample(n=10_000, random_state=42)\n\n# execute the engine steps\nengine.split(                         # split data as PQT files for `trn` + `val` to `{ws}/OriginalData/tgt-data`\n    workspace_dir=ws,\n    tgt_data=trn_df,\n    tgt_encoding_types={\n        'category': 'LANGUAGE_CATEGORICAL',\n        'date': 'LANGUAGE_DATETIME',\n        'headline': 'LANGUAGE_TEXT',\n    }\n)\nengine.analyze(workspace_dir=ws)      # generate column-level statistics to `{ws}/ModelStore/tgt-stats/stats.json`\nengine.encode(workspace_dir=ws)       # encode training data to `{ws}/OriginalData/encoded-data`\nengine.train(                         # train model and store to `{ws}/ModelStore/model-data`\n    workspace_dir=ws,\n    max_training_time=2,                   # limit TRAIN to 2 minute for demo purposes\n    model=\"MOSTLY_AI/LSTMFromScratch-3m\",  # use a light-weight LSTM model, trained from scratch (GPU recommended)\n    # model=\"microsoft/phi-1.5\",           # alternatively use a pre-trained HF-hosted LLM model (GPU required)\n)\nengine.generate(                      # use model to generate synthetic samples to `{ws}/SyntheticData`\n    workspace_dir=ws,\n    sample_size=10,\n)\npd.read_parquet(ws / \"SyntheticData\") # load synthetic data\n</code></pre>"},{"location":"api/","title":"API Reference","text":""},{"location":"api/#engine-reference","title":"Engine Reference","text":""},{"location":"api/#mostlyai.engine.split","title":"mostlyai.engine.split","text":"<pre><code>split(\n    tgt_data,\n    *,\n    ctx_data=None,\n    tgt_primary_key=None,\n    ctx_primary_key=None,\n    tgt_context_key=None,\n    model_type=None,\n    tgt_encoding_types=None,\n    ctx_encoding_types=None,\n    n_partitions=1,\n    trn_val_split=0.8,\n    workspace_dir=\"engine-ws\",\n    update_progress=None\n)\n</code></pre> <p>Splits the provided original data into training and validation sets, and stores these as partitioned Parquet files. This is a simplified version of <code>mostlyai-data</code>, tailored towards single- and two-table use cases, while requiring all data to be passed as DataFrames in memory.</p> <p>Creates the following folder structure within the <code>workspace_dir</code>:</p> <ul> <li><code>OriginalData/tgt-data</code>: Partitioned target data files.</li> <li><code>OriginalData/tgt-meta</code>: Metadata files for target data.</li> <li><code>OriginalData/ctx-data</code>: Partitioned context data files (if context is provided).</li> <li><code>OriginalData/ctx-meta</code>: Metadata files for context data (if context is provided).</li> </ul> <p>Parameters:</p> Name Type Description Default <code>tgt_data</code> <code>DataFrame</code> <p>DataFrame containing the target data.</p> required <code>ctx_data</code> <code>DataFrame | None</code> <p>DataFrame containing the context data.</p> <code>None</code> <code>tgt_primary_key</code> <code>str | None</code> <p>Primary key column name in the target data.</p> <code>None</code> <code>ctx_primary_key</code> <code>str | None</code> <p>Primary key column name in the context data.</p> <code>None</code> <code>tgt_context_key</code> <code>str | None</code> <p>Context key column name in the target data.</p> <code>None</code> <code>model_type</code> <code>str | ModelType | None</code> <p>Model type for the target data. If not provided, it will be inferred from the encoding types, or set to TABULAR by default.</p> <code>None</code> <code>tgt_encoding_types</code> <code>dict[str, str | ModelEncodingType] | None</code> <p>Encoding types for columns in the target data (excluding key columns).</p> <code>None</code> <code>ctx_encoding_types</code> <code>dict[str, str | ModelEncodingType] | None</code> <p>Encoding types for columns in the context data (excluding key columns).</p> <code>None</code> <code>n_partitions</code> <code>int</code> <p>Number of partitions to split the data into.</p> <code>1</code> <code>trn_val_split</code> <code>float</code> <p>Fraction of data to use for training, with the remaining data used for validation.</p> <code>0.8</code> <code>workspace_dir</code> <code>str | Path</code> <p>Path to the workspace directory where files will be created.</p> <code>'engine-ws'</code> <code>update_progress</code> <code>ProgressCallback | None</code> <p>A custom progress callback.</p> <code>None</code>"},{"location":"api/#mostlyai.engine.analyze","title":"mostlyai.engine.analyze","text":"<pre><code>analyze(\n    *,\n    value_protection=True,\n    differential_privacy=None,\n    workspace_dir=\"engine-ws\",\n    update_progress=None\n)\n</code></pre> <p>Generates (privacy-safe) column-level statistics of the original data, that has been <code>split</code> into the workspace. This information is required for encoding the original as well as for decoding the generating data.</p> <p>Creates the following folder structure within the <code>workspace_dir</code>:</p> <ul> <li><code>ModelStore/tgt-stats/stats.json</code>: Column-level statistics for target data</li> <li><code>ModelStore/ctx-stats/stats.json</code>: Column-level statistics for context data (if context is provided).</li> </ul> <p>Parameters:</p> Name Type Description Default <code>value_protection</code> <code>bool</code> <p>Whether to enable value protection for rare values.</p> <code>True</code> <code>workspace_dir</code> <code>str | Path</code> <p>Path to workspace directory containing partitioned data.</p> <code>'engine-ws'</code> <code>update_progress</code> <code>ProgressCallback | None</code> <p>Optional callback to update progress during analysis.</p> <code>None</code>"},{"location":"api/#mostlyai.engine.encode","title":"mostlyai.engine.encode","text":"<pre><code>encode(*, workspace_dir='engine-ws', update_progress=None)\n</code></pre> <p>Encodes data in the workspace that has already been split and analyzed.</p> <p>Creates the following folder structure within the <code>workspace_dir</code>:</p> <ul> <li><code>OriginalData/encoded-data</code>: Encoded data for training, stored as parquet files.</li> </ul> <p>Parameters:</p> Name Type Description Default <code>workspace_dir</code> <code>str | Path</code> <p>Directory path for workspace.</p> <code>'engine-ws'</code> <code>update_progress</code> <code>ProgressCallback | None</code> <p>Callback for progress updates.</p> <code>None</code>"},{"location":"api/#mostlyai.engine.train","title":"mostlyai.engine.train","text":"<pre><code>train(\n    *,\n    model=None,\n    max_training_time=14400.0,\n    max_epochs=100.0,\n    batch_size=None,\n    gradient_accumulation_steps=None,\n    enable_flexible_generation=True,\n    max_sequence_window=None,\n    differential_privacy=None,\n    model_state_strategy=ModelStateStrategy.reset,\n    device=None,\n    workspace_dir=\"engine-ws\",\n    update_progress=None,\n    upload_model_data_callback=None\n)\n</code></pre> <p>Trains a model with optional early stopping and differential privacy.</p> <p>Creates the following folder structure within the <code>workspace_dir</code>:</p> <ul> <li><code>ModelStore</code>: Trained model checkpoints and logs.</li> </ul> <p>Parameters:</p> Name Type Description Default <code>model</code> <code>str | None</code> <p>The identifier of the model to train. If tabular, defaults to MOSTLY_AI/Medium. If language, defaults to MOSTLY_AI/LSTMFromScratch-3m.</p> <code>None</code> <code>max_training_time</code> <code>float | None</code> <p>Maximum training time in minutes. If None, defaults to 10 days.</p> <code>14400.0</code> <code>max_epochs</code> <code>float | None</code> <p>Maximum number of training epochs. If None, defaults to 100 epochs.</p> <code>100.0</code> <code>batch_size</code> <code>int | None</code> <p>Per-device batch size for training and validation. If None, determined automatically.</p> <code>None</code> <code>gradient_accumulation_steps</code> <code>int | None</code> <p>Number of steps to accumulate gradients. If None, determined automatically.</p> <code>None</code> <code>enable_flexible_generation</code> <code>bool</code> <p>Whether to enable flexible order generation. Defaults to True.</p> <code>True</code> <code>max_sequence_window</code> <code>int | None</code> <p>Maximum sequence window for tabular sequential models. Only applicable for tabular models.</p> <code>None</code> <code>differential_privacy</code> <code>DifferentialPrivacyConfig | dict | None</code> <p>Configuration for differential privacy training. If None, DP is disabled.</p> <code>None</code> <code>model_state_strategy</code> <code>ModelStateStrategy</code> <p>Strategy for handling existing model state (reset/resume/reuse).</p> <code>reset</code> <code>device</code> <code>device | str | None</code> <p>Device to run training on ('cuda' or 'cpu'). Defaults to 'cuda' if available, else 'cpu'.</p> <code>None</code> <code>workspace_dir</code> <code>str | Path</code> <p>Directory path for workspace. Training outputs are stored in ModelStore subdirectory.</p> <code>'engine-ws'</code> <code>update_progress</code> <code>ProgressCallback | None</code> <p>Callback function to report training progress.</p> <code>None</code> <code>upload_model_data_callback</code> <code>Callable | None</code> <p>Callback function to upload model data during training.</p> <code>None</code>"},{"location":"api/#mostlyai.engine.generate","title":"mostlyai.engine.generate","text":"<pre><code>generate(\n    *,\n    ctx_data=None,\n    seed_data=None,\n    sample_size=None,\n    batch_size=None,\n    sampling_temperature=1.0,\n    sampling_top_p=1.0,\n    device=None,\n    rare_category_replacement_method=RareCategoryReplacementMethod.constant,\n    rebalancing=None,\n    imputation=None,\n    fairness=None,\n    workspace_dir=\"engine-ws\",\n    update_progress=None\n)\n</code></pre> <p>Generates synthetic data from a trained model.</p> <p>Creates the following folder structure within the <code>workspace_dir</code>:</p> <ul> <li><code>SyntheticData</code>: Generated synthetic data, stored as parquet files.</li> </ul> <p>Parameters:</p> Name Type Description Default <code>ctx_data</code> <code>DataFrame | None</code> <p>Context data to be used for generation.</p> <code>None</code> <code>seed_data</code> <code>DataFrame | None</code> <p>Seed data to condition generation on fixed target columns.</p> <code>None</code> <code>sample_size</code> <code>int | None</code> <p>Number of samples to generate. Defaults to number of original samples.</p> <code>None</code> <code>batch_size</code> <code>int | None</code> <p>Batch size for generation. If None, determined automatically.</p> <code>None</code> <code>sampling_temperature</code> <code>float</code> <p>Sampling temperature. Higher values increase randomness.</p> <code>1.0</code> <code>sampling_top_p</code> <code>float</code> <p>Nucleus sampling probability threshold.</p> <code>1.0</code> <code>device</code> <code>str | None</code> <p>Device to run generation on ('cuda' or 'cpu'). Defaults to 'cuda' if available, else 'cpu'.</p> <code>None</code> <code>rare_category_replacement_method</code> <code>RareCategoryReplacementMethod | str</code> <p>Method for handling rare categories. Only applicable for tabular models.</p> <code>constant</code> <code>rebalancing</code> <code>RebalancingConfig | dict | None</code> <p>Configuration for rebalancing column distributions. Only applicable for tabular models.</p> <code>None</code> <code>imputation</code> <code>ImputationConfig | dict | None</code> <p>List of columns to impute missing values. Only applicable for tabular models.</p> <code>None</code> <code>fairness</code> <code>FairnessConfig | dict | None</code> <p>Configuration for fairness constraints. Only applicable for tabular models.</p> <code>None</code> <code>workspace_dir</code> <code>str | Path</code> <p>Directory path for workspace.</p> <code>'engine-ws'</code> <code>update_progress</code> <code>ProgressCallback | None</code> <p>Callback for progress updates.</p> <code>None</code>"},{"location":"api/#schema-reference","title":"Schema Reference","text":""},{"location":"api/#mostlyai.engine.domain.DifferentialPrivacyConfig","title":"mostlyai.engine.domain.DifferentialPrivacyConfig","text":"<p>The differential privacy configuration for training the model. If not provided, then no differential privacy will be applied.</p> <p>Parameters:</p> Name Type Description Default <code>max_epsilon</code> <code>float | None</code> <p>Specifies the maximum allowable epsilon value. If the training process exceeds this threshold, it will be terminated early. Only model checkpoints with epsilon values below this limit will be retained. If not provided, the training will proceed without early termination based on epsilon constraints.</p> <code>10.0</code> <code>delta</code> <code>float</code> <p>The delta value for differential privacy. It is the probability of the privacy guarantee not holding. The smaller the delta, the more confident you can be that the privacy guarantee holds. This delta will be equally distributed between the analysis and the training phase.</p> <code>1e-05</code> <code>noise_multiplier</code> <code>float</code> <p>Determines how much noise while training the model with differential privacy. This is the ratio of the standard deviation of the Gaussian noise to the L2-sensitivity of the function to which the noise is added.</p> <code>1.5</code> <code>max_grad_norm</code> <code>float</code> <p>Determines the maximum impact of a single sample on updating the model weights during training with differential privacy. This is the maximum norm of the per-sample gradients.</p> <code>1.0</code> <code>value_protection_epsilon</code> <code>float | None</code> <p>The DP epsilon of the privacy budget for determining the value ranges, which are gathered prior to the model training during the analysis step. Only applicable if value protection is True. Privacy budget will be equally distributed between the columns. For categorical we calculate noisy histograms and use a noisy threshold. For numeric and datetime we calculate bounds based on noisy histograms.</p> <code>1.0</code>"},{"location":"api/#mostlyai.engine.domain.FairnessConfig","title":"mostlyai.engine.domain.FairnessConfig","text":"<p>Configure a fairness objective for the table.</p> <p>The generated synthetic data will maintain robust statistical parity between the target column and the specified sensitive columns. All these columns must be categorical.</p> <p>Parameters:</p> Name Type Description Default <code>target_column</code> <code>str</code> required <code>sensitive_columns</code> <code>list[str]</code> required"},{"location":"api/#mostlyai.engine.domain.ImputationConfig","title":"mostlyai.engine.domain.ImputationConfig","text":"<p>Configure imputation. Imputed columns will suppress the sampling of NULL values.</p> <p>Parameters:</p> Name Type Description Default <code>columns</code> <code>list[str]</code> <p>The names of the columns to be imputed.</p> required"},{"location":"api/#mostlyai.engine.domain.ModelEncodingType","title":"mostlyai.engine.domain.ModelEncodingType","text":"<p>The encoding type used for model training and data generation.</p> <ul> <li><code>AUTO</code>: Model chooses among available encoding types based on the column's data type.</li> <li><code>TABULAR_CATEGORICAL</code>: Model samples from existing (non-rare) categories.</li> <li><code>TABULAR_NUMERIC_AUTO</code>: Model chooses among 3 numeric encoding types based on the values.</li> <li><code>TABULAR_NUMERIC_DISCRETE</code>: Model samples from existing discrete numerical values.</li> <li><code>TABULAR_NUMERIC_BINNED</code>: Model samples from binned buckets, to then sample randomly within a bucket.</li> <li><code>TABULAR_NUMERIC_DIGIT</code>: Model samples each digit of a numerical value.</li> <li><code>TABULAR_CHARACTER</code>: Model samples each character of a string value.</li> <li><code>TABULAR_DATETIME</code>: Model samples each part of a datetime value.</li> <li><code>TABULAR_DATETIME_RELATIVE</code>: Model samples the relative difference between datetimes within a sequence.</li> <li><code>TABULAR_LAT_LONG</code>: Model samples a latitude-longitude column. The format is \"latitude,longitude\".</li> <li><code>LANGUAGE_TEXT</code>: Model will sample free text, using a LANGUAGE model.</li> <li><code>LANGUAGE_CATEGORICAL</code>: Model samples from existing (non-rare) categories, using a LANGUAGE model.</li> <li><code>LANGUAGE_NUMERIC</code>: Model samples from the valid numeric value range, using a LANGUAGE model.</li> <li><code>LANGUAGE_DATETIME</code>: Model samples from the valid datetime value range, using a LANGUAGE model.</li> </ul>"},{"location":"api/#mostlyai.engine.domain.ModelStateStrategy","title":"mostlyai.engine.domain.ModelStateStrategy","text":"<p>The strategy of how any existing model states and training progress are to be handled.</p> <ul> <li><code>RESET</code>: Start training from scratch. Overwrite any existing model states and training progress.</li> <li><code>REUSE</code>: Reuse any existing model states, but start progress from scratch. Used for fine-tuning existing models.</li> <li><code>RESUME</code>: Reuse any existing model states and progress. Used for continuing an aborted training.</li> </ul>"},{"location":"api/#mostlyai.engine.domain.ModelType","title":"mostlyai.engine.domain.ModelType","text":"<p>The type of model.</p> <ul> <li><code>TABULAR</code>: A generative AI model tailored towards tabular data, trained from scratch.</li> <li><code>LANGUAGE</code>: A generative AI model build upon a (pre-trained) language model.</li> </ul>"},{"location":"api/#mostlyai.engine.domain.RareCategoryReplacementMethod","title":"mostlyai.engine.domain.RareCategoryReplacementMethod","text":"<p>Specifies how rare categories will be sampled. Only applicable if value protection has been enabled.</p> <ul> <li><code>CONSTANT</code>: Replace rare categories by a constant <code>_RARE_</code> token.</li> <li><code>SAMPLE</code>: Replace rare categories by a sample from non-rare categories.</li> </ul>"},{"location":"api/#mostlyai.engine.domain.RebalancingConfig","title":"mostlyai.engine.domain.RebalancingConfig","text":"<p>Configure rebalancing.</p> <p>Parameters:</p> Name Type Description Default <code>column</code> <code>str</code> <p>The name of the column to be rebalanced.</p> required <code>probabilities</code> <code>dict[str, float]</code> <p>The target distribution of samples values. The keys are the categorical values, and the values are the probabilities.</p> required"}]}